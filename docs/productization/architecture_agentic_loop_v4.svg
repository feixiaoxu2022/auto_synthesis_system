<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1700 1700">
  <!-- å®šä¹‰æ ·å¼ -->
  <defs>
    <style>
      .orchestrator-box { fill: #fff7e6; stroke: #fa8c16; stroke-width: 4; rx: 15; }
      .layer-box { fill: #f0f4f8; stroke: #2d3748; stroke-width: 3; rx: 10; }
      .init-agent { fill: #e6f7ff; stroke: #1890ff; stroke-width: 5; rx: 12; }
      .execute-agent { fill: #f6ffed; stroke: #52c41a; stroke-width: 5; rx: 12; }
      .human-box { fill: #ffd700; stroke: #ff8c00; stroke-width: 3; rx: 10; }
      .skills-box { fill: #f0e6ff; stroke: #722ed1; stroke-width: 4; rx: 10; }
      .gate-box { fill: #fffbe6; stroke: #faad14; stroke-width: 2; rx: 8; stroke-dasharray: 5,3; }

      .title-text { font-family: Arial, sans-serif; font-size: 28px; font-weight: bold; fill: #1a202c; }
      .subtitle-text { font-family: Arial, sans-serif; font-size: 16px; fill: #4a5568; }
      .agent-title { font-family: Arial, sans-serif; font-size: 20px; font-weight: bold; fill: #1a202c; }
      .section-title { font-family: Arial, sans-serif; font-size: 15px; font-weight: bold; fill: #2d3748; }
      .small-text { font-family: Arial, sans-serif; font-size: 12px; fill: #4a5568; }
      .orchestrator-title { font-family: Arial, sans-serif; font-size: 22px; font-weight: bold; fill: #fa8c16; }

      .arrow { stroke: #2d3748; stroke-width: 3; fill: none; marker-end: url(#arrowhead); }
      .handoff-arrow { stroke: #fa8c16; stroke-width: 4; fill: none; marker-end: url(#handoff-arrowhead); }
      .feedback-arrow { stroke: #eb2f96; stroke-width: 3; fill: none; marker-end: url(#feedback-arrowhead); stroke-dasharray: 8,4; }
      .skills-arrow { stroke: #722ed1; stroke-width: 2; fill: none; marker-end: url(#skills-arrowhead); stroke-dasharray: 6,3; }
    </style>

    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#2d3748" />
    </marker>
    <marker id="handoff-arrowhead" markerWidth="12" markerHeight="12" refX="10" refY="3" orient="auto">
      <polygon points="0 0, 12 3, 0 6" fill="#fa8c16" />
    </marker>
    <marker id="feedback-arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#eb2f96" />
    </marker>
    <marker id="skills-arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#722ed1" />
    </marker>

    <!-- HITLå›¾æ ‡ -->
    <symbol id="hitl-icon" viewBox="0 0 24 24">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" stroke="#ff8c00" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M6 21v-2a4 4 0 0 1 4 -4h2.5" stroke="#ff8c00" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M19.001 19m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" stroke="#ff8c00" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M19.001 15.5v1.5" stroke="#ff8c00" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M19.001 21v1.5" stroke="#ff8c00" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M22.032 17.25l-1.299 .75" stroke="#ff8c00" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M17.27 20l-1.3 .75" stroke="#ff8c00" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M15.97 17.25l1.3 .75" stroke="#ff8c00" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
      <path d="M20.733 20l1.3 .75" stroke="#ff8c00" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"/>
    </symbol>
  </defs>

  <!-- æ ‡é¢˜ -->
  <text x="850" y="35" class="title-text" text-anchor="middle">Harness + åŒAgentåä½œæ¶æ„</text>
  <text x="850" y="58" class="subtitle-text" text-anchor="middle">Orchestratorï¼ˆçŠ¶æ€ç®¡ç†+é—¨æ§+Checkpointï¼‰+ Init/Executeï¼ˆè‡ªæ²»å†³ç­–ï¼‰</text>

  <!-- ========== Orchestrator å¤–å±‚æ¡† ========== -->
  <rect x="40" y="80" width="1200" height="1530" class="orchestrator-box" />
  <text x="640" y="110" class="orchestrator-title" text-anchor="middle">Orchestrator (Harness/Coordinator)</text>

  <!-- Orchestrator èŒè´£ -->
  <rect x="70" y="125" width="1140" height="60" fill="#fff" stroke="#fa8c16" stroke-width="2" rx="8"/>
  <text x="90" y="148" class="section-title">æ ¸å¿ƒèŒè´£ï¼šâ‘  çŠ¶æ€ç®¡ç†  â‘¡ Checkpoint &amp; Resume  â‘¢ çŠ¶æ€é—¨æ§ï¼ˆGateï¼‰  â‘£ Agentåè°ƒ  â‘¤ HITLç®¡ç†</text>
  <text x="90" y="168" class="small-text" font-style="italic">ä¸åšä¸šåŠ¡å†³ç­–ï¼ŒInit/Execute å®Œå…¨è‡ªæ²»</text>

  <!-- ç”¨æˆ·è¾“å…¥ -->
  <rect x="440" y="210" width="400" height="55" class="layer-box" />
  <text x="640" y="233" class="section-title" text-anchor="middle">ç”¨æˆ·è¾“å…¥</text>
  <text x="640" y="252" class="small-text" text-anchor="middle">ä¸šåŠ¡åœºæ™¯æè¿°</text>

  <path d="M 640 265 L 640 295" class="arrow" />

  <!-- ========== Init Agent ========== -->
  <rect x="240" y="295" width="800" height="280" class="init-agent" />
  <text x="640" y="325" class="agent-title" text-anchor="middle">Init Agentï¼ˆè‡ªæ²»ï¼‰</text>

  <!-- Layer 1 -->
  <rect x="270" y="345" width="740" height="80" class="layer-box" />
  <text x="640" y="368" class="section-title" text-anchor="middle">Layer 1: åœºæ™¯ç†è§£ä¸è®¾è®¡</text>
  <text x="290" y="388" class="small-text">è¾“å‡ºï¼šunified_scenario_design.yaml | BusinessRules.md | format_specifications.json</text>
  <text x="290" y="408" class="small-text">æ¨¡å‹ï¼šClaude Opus 4.5 + Extended Thinking</text>

  <!-- HITL-1 -->
  <rect x="1280" y="355" width="340" height="75" class="human-box" />
  <use href="#hitl-icon" x="1290" y="365" width="20" height="20"/>
  <text x="1450" y="380" class="section-title" text-anchor="middle">HITL-1 (å¿…é¡»)</text>
  <text x="1315" y="398" class="small-text">Review | 100% | 10-20min | y/n</text>
  <text x="1315" y="415" class="small-text">Checkpointä¿å­˜ç‚¹</text>

  <!-- Initå†³ç­– -->
  <rect x="270" y="440" width="740" height="60" fill="#fff" stroke="#1890ff" stroke-width="2" stroke-dasharray="5,3" rx="8"/>
  <text x="640" y="463" class="section-title" text-anchor="middle">Init Agent è‡ªä¸»å†³ç­–</text>
  <text x="290" y="482" class="small-text">é€šè¿‡Review â†’ handoffåˆ°Execute | éœ€ä¿®æ”¹ â†’ é‡æ–°è®¾è®¡</text>

  <!-- Gate -->
  <rect x="440" y="590" width="400" height="50" class="gate-box" />
  <text x="640" y="610" class="section-title" text-anchor="middle" fill="#faad14">Gate: âœ“ YAML âœ“ BusinessRules âœ“ HITL-1æ‰¹å‡†</text>

  <path d="M 640 575 L 640 590" class="handoff-arrow" />
  <path d="M 640 640 L 640 680" class="handoff-arrow" />
  <text x="660" y="665" class="section-title" fill="#fa8c16">Handoff</text>

  <!-- ========== Execute Agent ========== -->
  <rect x="240" y="680" width="800" height="650" class="execute-agent" />
  <text x="640" y="710" class="agent-title" text-anchor="middle">Execute Agentï¼ˆè‡ªæ²»ï¼‰</text>

  <!-- Layer 2 -->
  <rect x="270" y="730" width="740" height="80" class="layer-box" />
  <text x="640" y="753" class="section-title" text-anchor="middle">Layer 2: ç»„ä»¶ä»£ç ç”Ÿæˆ</text>
  <text x="290" y="773" class="small-text">Tools | Checkers | æ•°æ®æ±  + å•å…ƒæµ‹è¯•</text>
  <text x="290" y="793" class="small-text">Claude Sonnet 4.5 | è½¯10æ¬¡/ç¡¬30æ¬¡ | æ— HITL</text>

  <path d="M 640 810 L 640 840" class="arrow" />

  <!-- Layer 3 -->
  <rect x="270" y="850" width="740" height="80" class="layer-box" />
  <text x="640" y="873" class="section-title" text-anchor="middle">Layer 3: æ ·æœ¬åˆæˆ</text>
  <text x="290" y="893" class="small-text">coverage matrix + data pool + prompt</text>
  <text x="290" y="913" class="small-text">Claude Sonnet 4.5 | è½¯20æ¬¡/ç¡¬50æ¬¡</text>

  <path d="M 640 930 L 640 960" class="arrow" />

  <!-- Layer 4 -->
  <rect x="270" y="970" width="740" height="80" class="layer-box" />
  <text x="640" y="993" class="section-title" text-anchor="middle">Layer 4: è‡ªåŠ¨è¯„æµ‹ä¸å½’å› </text>
  <text x="290" y="1013" class="small-text">çœŸå®æ‰§è¡Œ + Checker + LLMè¯„åˆ¤ + æ™ºèƒ½å½’å› </text>
  <text x="290" y="1033" class="small-text">å¾…è¯„æµ‹æ¨¡å‹ + Claude Opus 4.5 | ç›®æ ‡â‰¥85%</text>

  <!-- HITL-2 -->
  <rect x="1280" y="980" width="340" height="75" class="human-box" />
  <use href="#hitl-icon" x="1290" y="990" width="20" height="20"/>
  <text x="1450" y="1005" class="section-title" text-anchor="middle">HITL-2 (æ¡ä»¶)</text>
  <text x="1315" y="1023" class="small-text">é¦–æ¬¡å½’å›  | ~20% | 3-5min | y/n</text>
  <text x="1315" y="1040" class="small-text">Checkpointä¿å­˜ç‚¹</text>

  <!-- Executeå†³ç­– -->
  <rect x="270" y="1065" width="740" height="160" fill="#fff" stroke="#52c41a" stroke-width="2" stroke-dasharray="5,3" rx="8"/>
  <text x="640" y="1088" class="section-title" text-anchor="middle">Execute Agent è‡ªä¸»å†³ç­–ï¼ˆè§„åˆ™å¼•æ“ï¼‰</text>
  <text x="290" y="1108" class="small-text">âœ… è´¨é‡è¾¾æ ‡ â†’ completed â†’ Orchestratorè¾“å‡º</text>
  <text x="290" y="1128" class="small-text">ğŸ”„ Layer 2/3é—®é¢˜ â†’ è‡ªå·±ä¿®å¤ç»§ç»­è¿­ä»£</text>
  <text x="290" y="1148" class="small-text">âš ï¸ Layer 1é—®é¢˜ â†’ need_layer1_fix â†’ HITL-3</text>
  <text x="290" y="1168" class="small-text">â¸ï¸ è´¨é‡æ”¶æ•›/éœ‡è¡ â†’ stopped â†’ è¾“å‡º</text>
  <text x="290" y="1188" class="small-text">ğŸ›‘ Critical>30% â†’ critical â†’ HITL-3</text>
  <text x="290" y="1208" class="small-text">æ¨¡å—ï¼šQualityConvergence | LayerBudget | ProblemType</text>

  <!-- è‡ªä¿®å¤å¾ªç¯ -->
  <path d="M 270 1135 L 180 1135 L 180 770 L 270 770" class="feedback-arrow" />
  <text x="160" y="950" class="small-text" fill="#eb2f96" transform="rotate(-90 160 950)">è‡ªä¿®å¤</text>

  <!-- Gate -->
  <rect x="440" y="1350" width="400" height="50" class="gate-box" />
  <text x="640" y="1370" class="section-title" text-anchor="middle" fill="#faad14">Gate: âœ“ è¿­ä»£å®Œæˆ âœ“ å½’å› å®Œæˆ âœ“ Layer1é—®é¢˜ âœ“ HITL-3æ‰¹å‡†</text>

  <path d="M 640 1330 L 640 1350" class="handoff-arrow" />
  <path d="M 640 1400 L 640 1430" class="handoff-arrow" />

  <!-- HITL-3 -->
  <rect x="370" y="1430" width="540" height="75" class="human-box" />
  <use href="#hitl-icon" x="380" y="1440" width="20" height="20"/>
  <text x="640" y="1458" class="section-title" text-anchor="middle">HITL-3: Layer 1çº§åˆ«é—®é¢˜</text>
  <text x="405" y="1476" class="small-text">Critical>30%æˆ–åå¤å‡ºç° | ~15% | 15-30min | y=åŒæ„ä¿®æ”¹ n=æ¥å—ç°çŠ¶</text>
  <text x="405" y="1493" class="small-text">Checkpointä¿å­˜ç‚¹</text>

  <!-- å›Initçš„ç®­å¤´ -->
  <path d="M 910 1465 L 1180 1465 L 1180 390 L 1040 390" class="handoff-arrow" />
  <text x="1200" y="925" class="section-title" fill="#fa8c16" transform="rotate(-90 1200 925)">Handoffå›Init</text>

  <!-- æ¥å—ç»“æœ -->
  <path d="M 820 1505 L 820 1570 L 1280 1570" class="arrow" />
  <text x="840" y="1540" class="small-text">æ¥å—ç»“æœ</text>

  <!-- è´¨é‡è¾¾æ ‡ -->
  <path d="M 1010 1140 L 1170 1140 L 1170 1530" class="arrow" />
  <text x="1030" y="1135" class="small-text">è´¨é‡è¾¾æ ‡</text>

  <!-- æœ€ç»ˆè¾“å‡º -->
  <rect x="1280" y="1500" width="340" height="105" class="layer-box" />
  <text x="1450" y="1525" class="section-title" text-anchor="middle">æœ€ç»ˆè¾“å‡º</text>
  <text x="1300" y="1548" class="small-text">è¯„æµ‹æŠ¥å‘Š + å½’å› åˆ†æ</text>
  <text x="1300" y="1568" class="small-text">ä¼˜åŒ–å»ºè®® + è´¨é‡æŒ‡æ ‡</text>
  <text x="1300" y="1588" class="small-text">Checkpointå†å²</text>

  <!-- Skills -->
  <rect x="20" y="730" width="120" height="280" class="skills-box" />
  <text x="80" y="758" class="section-title" text-anchor="middle">Skills</text>
  <text x="35" y="780" class="small-text">å‚è€ƒæ ·æœ¬</text>
  <text x="35" y="800" class="small-text">ä¸šåŠ¡è§„åˆ™</text>
  <text x="35" y="820" class="small-text">æ ¼å¼è§„èŒƒ</text>
  <text x="35" y="840" class="small-text">ä»£ç æ¨¡æ¿</text>
  <text x="35" y="860" class="small-text">è®¾è®¡æ¨¡å¼</text>
  <text x="35" y="880" class="small-text">ç»éªŒæ•™è®­</text>

  <path d="M 140 765 L 270 395" class="skills-arrow" />
  <path d="M 140 805 L 270 770" class="skills-arrow" />
  <path d="M 140 845 L 270 890" class="skills-arrow" />
  <path d="M 140 885 L 270 1010" class="skills-arrow" />

  <!-- å›¾ä¾‹ -->
  <rect x="50" y="1640" width="800" height="50" fill="#fff" stroke="#2d3748" stroke-width="1" rx="5"/>
  <text x="70" y="1660" class="small-text" font-weight="bold">å›¾ä¾‹ï¼š</text>
  <rect x="110" y="1648" width="50" height="18" class="orchestrator-box" />
  <text x="165" y="1660" class="small-text">Orchestrator</text>
  <rect x="250" y="1648" width="50" height="18" class="init-agent" />
  <text x="305" y="1660" class="small-text">Init</text>
  <rect x="350" y="1648" width="50" height="18" class="execute-agent" />
  <text x="405" y="1660" class="small-text">Execute</text>
  <line x1="470" y1="1657" x2="530" y2="1657" class="handoff-arrow" />
  <text x="535" y="1660" class="small-text">Handoff</text>
  <line x1="610" y1="1657" x2="670" y2="1657" class="feedback-arrow" />
  <text x="675" y="1660" class="small-text">åé¦ˆ</text>

  <text x="70" y="1680" class="small-text" font-weight="bold">3ä¸ªHITLç‚¹ï¼šHITL-1 Layer1è®¾è®¡(100%)  |  HITL-2 é¦–æ¬¡å½’å› (~20%)  |  HITL-3 Layer1é—®é¢˜(~15%)</text>

  <text x="850" y="1670" class="small-text" text-anchor="middle" font-weight="bold">Orchestrator = çŠ¶æ€ç®¡ç† + Gateé—¨æ§ + Checkpoint + Agentåè°ƒï¼ˆä¸åšä¸šåŠ¡å†³ç­–ï¼‰</text>
</svg>
